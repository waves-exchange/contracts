# Force Stop Contract


## Keys
| key                         |      type | value                    | description                                       |
| :-------------------------- | --------: | :----------------------- | :------------------------------------------------ |
| `%s%s__disabled__{address}` | `boolean` | `true`                   | Contract status                                   |
| `%s__forceStopPermission`   |  `String` | `{address1}__{address2}` | List of Addresses allowed to force stop Contracts |


## Function
```
@Callable(i)
func forceStopContract(address: String, disable: Boolean)
```

## Изменения в контрактах
Необходимо во **все** `@Callable` функции контракта добавить проверку статуса.

### Новый ключ
`%s__forceStopStateAddress`

### Алгоритм
1. Контракт активен по-умолчанию
2. Получить из собственного стейта адрес контракта со статусами (*FSC*)
   - Если ключ не найден, вернуть собственный адрес
3. Сгенерировать ключ статуса на себя `%s%s__disabled__{this}`
4. Получить из стейта *FSC* значение статуса
   - Если ключ не найден, вернуть `false`
5. Если значение равно `true`, то контракт выдаёт ошибку (`throw()`)


## LP/LP STABLE
Если выключен адрес `Factory_v2`, то все контракты пулов отключаются одновременно

### Алгоритм lp.ride or lp_stable.ride
1. Контракт активен по-умолчанию
2. Получить из собственного стейта адрес `Factory_v2`
   - Если ключ не найден, вернуть собственный адрес
3. Получить из стейта `Factory_v2` адрес контракта со статусами (*FSC*)
   - Если ключ не найден, вернуть собственный адрес
4. Сгенерировать ключ статуса на себя `%s%s__disabled__{this}`
5. Получить из стейта *FSC* значение статуса
   - Если ключ не найден, вернуть `false`
6. Если значение равно `true`, то контракт выдаёт ошибку (`throw()`)
7. Получить из собственного стейта адрес `Factory_v2`
   - Если ключ не найден, вернуть собственный адрес
8. Сгенерировать ключ статуса для `Factory_v2` `%s%s__disabled__{factory_v2}`
9.  Получить из стейта *FSC* значение статуса
   - Если ключ не найден, вернуть `false`
10. Если значение равно `true`, то контракт выдаёт ошибку (`throw()`)